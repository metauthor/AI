# Output generated by @ua_chatgpt_bot

Ваше питання: write code for telegram jwt auth using nest js

Відповідь: import { Injectable } from "@nestjs/common";
import * as jwt from "jsonwebtoken";
import { TelegramAuthService } from "./telegram.auth.service";

@Injectable()
export class TelegramJWTAuthService {

constructor(
    private readonly telegramAuthService: TelegramAuthService
  ) {}
  
  async createToken(userId: string): Promise<string> {
    const accessToken = await this.telegramAuthService.getAccessToken(userId);
    const jwtPayload = {
      userId,
      accessToken,
    };
    return jwt.sign(jwtPayload, process.env.JWT_SECRET);
  }

  async validateUser(payload: any): Promise<boolean> {
    const accessToken = await this.telegramAuthService.getAccessToken(
      payload.userId
    );
    return accessToken === payload.accessToken;
  }
}

